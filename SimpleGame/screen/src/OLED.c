/*
 Copyright (C), 2022 Joshua B. Russell
 This program is free software: you can redistribute it and/or modify it under
 the terms of the GNU General Public License as published by the Free 
 Software Foundation, either version 3 of the License, or (at your option) any
 later version.
 This program is distributed in the hope that it will be useful, but WITHOUT
 ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
 details.
 You should have received a copy of the GNU General Public License along with 
 this program. If not, see <https://www.gnu.org/licenses/>. 
*/


#include "OLED.h"

#include <stdbool.h>
#include <stdint.h>
#include <string.h>

#include "mess_transf.h"


static uint8_t const font16x12[95][32] = {
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /*   */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* ! */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x36,0x00, 0x36,0x00, 0x36,0x00, 0x36,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* " */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x09,0x80, 0x19,0x00, 0x1B,0x00, 0x7F,0xC0, 0x13,0x00, 0x32,0x00, 0x36,0x00, 0xFF,0x80, 0x26,0x00, 0x64,0x00, 0x6C,0x00, 0x00,0x00}, /* # */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x3F,0x00, 0x3F,0x00, 0x6C,0x00, 0x6C,0x00, 0x3E,0x00, 0x1F,0x00, 0x0D,0x80, 0x0D,0x80, 0x6F,0x80, 0x3F,0x00, 0x0C,0x00}, /* $ */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x78,0x00, 0xD8,0x00, 0xC8,0x00, 0xD8,0x00, 0x7B,0x80, 0x0E,0x00, 0x38,0x00, 0x67,0x80, 0x0C,0x80, 0x0C,0xC0, 0x0C,0x80, 0x07,0x80, 0x00,0x00}, /* % */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1E,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x38,0x00, 0x78,0x00, 0x6C,0xC0, 0xCE,0xC0, 0xC7,0x80, 0xC3,0x80, 0x73,0x80, 0x3F,0x80, 0x00,0x00}, /* & */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* ' */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x06,0x00, 0x04,0x00, 0x0C,0x00, 0x0C,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x0C,0x00, 0x0C,0x00, 0x04,0x00}, /* ( */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x18,0x00, 0x18,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0E,0x00, 0x0E,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x18,0x00}, /* ) */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x6F,0x00, 0x3E,0x00, 0x3E,0x00, 0x6F,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* * */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0xFF,0x80, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00}, /* + */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x1C,0x00}, /* , */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* - */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* . */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x03,0x00, 0x03,0x00, 0x07,0x00, 0x06,0x00, 0x06,0x00, 0x0C,0x00, 0x0C,0x00, 0x18,0x00, 0x18,0x00, 0x30,0x00, 0x30,0x00, 0x60,0x00, 0x60,0x00}, /* / */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1E,0x00, 0x33,0x00, 0x63,0x00, 0x61,0x80, 0x61,0x80, 0x6D,0x80, 0x6D,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x00, 0x33,0x00, 0x1E,0x00, 0x00,0x00}, /* 0 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3C,0x00, 0x3C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x3F,0x80, 0x00,0x00}, /* 1 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x77,0x00, 0x43,0x00, 0x03,0x00, 0x03,0x00, 0x07,0x00, 0x06,0x00, 0x0C,0x00, 0x1C,0x00, 0x38,0x00, 0x70,0x00, 0x7F,0x80, 0x00,0x00}, /* 2 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x67,0x00, 0x03,0x00, 0x03,0x00, 0x07,0x00, 0x1E,0x00, 0x07,0x00, 0x03,0x80, 0x01,0x80, 0x03,0x80, 0x67,0x00, 0x3E,0x00, 0x00,0x00}, /* 3 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x07,0x00, 0x0F,0x00, 0x0F,0x00, 0x1F,0x00, 0x37,0x00, 0x37,0x00, 0x67,0x00, 0x67,0x00, 0x7F,0x80, 0x07,0x00, 0x07,0x00, 0x07,0x00, 0x00,0x00}, /* 4 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x7E,0x00, 0x67,0x00, 0x03,0x00, 0x03,0x80, 0x03,0x80, 0x03,0x00, 0x67,0x00, 0x3E,0x00, 0x00,0x00}, /* 5 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1E,0x00, 0x31,0x00, 0x60,0x00, 0x60,0x00, 0x7E,0x00, 0x73,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x33,0x00, 0x1E,0x00, 0x00,0x00}, /* 6 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x80, 0x03,0x00, 0x03,0x00, 0x07,0x00, 0x06,0x00, 0x06,0x00, 0x0E,0x00, 0x0C,0x00, 0x0C,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x00,0x00}, /* 7 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x73,0x00, 0x63,0x80, 0x63,0x80, 0x33,0x00, 0x3E,0x00, 0x73,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x73,0x00, 0x3E,0x00, 0x00,0x00}, /* 8 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x77,0x00, 0x63,0x00, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x77,0x80, 0x3F,0x80, 0x01,0x80, 0x03,0x00, 0x27,0x00, 0x3E,0x00, 0x00,0x00}, /* 9 */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* : */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x1C,0x00}, /* ; */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x01,0x80, 0x07,0x80, 0x3E,0x00, 0xF0,0x00, 0xF0,0x00, 0x3E,0x00, 0x07,0x80, 0x01,0x80, 0x00,0x00, 0x00,0x00}, /* < */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xFF,0x80, 0x00,0x00, 0x00,0x00, 0xFF,0x80, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* = */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xE0,0x00, 0x78,0x00, 0x1F,0x00, 0x07,0x80, 0x07,0x80, 0x1F,0x00, 0x78,0x00, 0xE0,0x00, 0x00,0x00, 0x00,0x00}, /* > */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x33,0x00, 0x03,0x00, 0x03,0x00, 0x07,0x00, 0x0E,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* ? */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1F,0x00, 0x31,0x80, 0x60,0x80, 0x4F,0x80, 0xCD,0x80, 0xD8,0x80, 0xD8,0x80, 0xD8,0x80, 0xD8,0x80, 0xCD,0x80, 0x4F,0x80, 0x60,0x00}, /* @ */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1C,0x00, 0x1E,0x00, 0x1E,0x00, 0x1E,0x00, 0x36,0x00, 0x33,0x00, 0x33,0x00, 0x73,0x00, 0x7F,0x80, 0x61,0x80, 0xE1,0x80, 0xC1,0x80, 0x00,0x00}, /* A */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7E,0x00, 0x63,0x00, 0x61,0x80, 0x61,0x80, 0x63,0x00, 0x7F,0x00, 0x63,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x80, 0x7F,0x00, 0x00,0x00}, /* B */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1F,0x00, 0x39,0x80, 0x30,0x80, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x70,0x80, 0x39,0x80, 0x1F,0x00, 0x00,0x00}, /* C */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7E,0x00, 0x67,0x00, 0x63,0x00, 0x63,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x80, 0x63,0x00, 0x67,0x00, 0x7E,0x00, 0x00,0x00}, /* D */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x80, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x7F,0x80, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x7F,0x80, 0x00,0x00}, /* E */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3F,0x80, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x3F,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x00,0x00}, /* F */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1F,0x00, 0x33,0x80, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x67,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x31,0x80, 0x1F,0x00, 0x00,0x00}, /* G */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x7F,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x00,0x00}, /* H */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x7F,0x00, 0x00,0x00}, /* I */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1F,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x47,0x00, 0x66,0x00, 0x7C,0x00, 0x00,0x00}, /* J */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x61,0x80, 0x63,0x00, 0x66,0x00, 0x6E,0x00, 0x7C,0x00, 0x7C,0x00, 0x7C,0x00, 0x66,0x00, 0x67,0x00, 0x63,0x00, 0x63,0x80, 0x61,0xC0, 0x00,0x00}, /* K */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x70,0x00, 0x7F,0x80, 0x00,0x00}, /* L */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0xE3,0x80, 0xF3,0x80, 0xF3,0x80, 0xF7,0x80, 0xD7,0x80, 0xDD,0x80, 0xDD,0x80, 0xCD,0x80, 0xC1,0x80, 0xC1,0x80, 0xC1,0x80, 0xC1,0x80, 0x00,0x00}, /* M */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x71,0x80, 0x71,0x80, 0x71,0x80, 0x79,0x80, 0x79,0x80, 0x6D,0x80, 0x6D,0x80, 0x6D,0x80, 0x67,0x80, 0x67,0x80, 0x63,0x80, 0x63,0x80, 0x00,0x00}, /* N */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x33,0x00, 0x63,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x00, 0x33,0x00, 0x3E,0x00, 0x00,0x00}, /* O */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x00, 0x63,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x80, 0x7F,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x00,0x00}, /* P */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x33,0x00, 0x63,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x80, 0x33,0x00, 0x1E,0x00, 0x07,0x00}, /* Q */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7E,0x00, 0x67,0x00, 0x63,0x00, 0x63,0x80, 0x63,0x00, 0x67,0x00, 0x7E,0x00, 0x67,0x00, 0x63,0x00, 0x63,0x80, 0x61,0x80, 0x61,0xC0, 0x00,0x00}, /* R */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x73,0x00, 0x61,0x00, 0x60,0x00, 0x60,0x00, 0x3C,0x00, 0x1F,0x00, 0x03,0x80, 0x01,0x80, 0x41,0x80, 0x73,0x00, 0x3E,0x00, 0x00,0x00}, /* S */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0xFF,0xC0, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* T */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x73,0x00, 0x3E,0x00, 0x00,0x00}, /* U */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0xC1,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x00, 0x73,0x00, 0x33,0x00, 0x33,0x00, 0x36,0x00, 0x1E,0x00, 0x1E,0x00, 0x1C,0x00, 0x1C,0x00, 0x00,0x00}, /* V */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0xC0,0xC0, 0xC0,0xC0, 0xC0,0xC0, 0xCD,0x80, 0xDD,0x80, 0x5D,0x80, 0x7F,0x80, 0x77,0x80, 0x77,0x80, 0x73,0x80, 0x73,0x00, 0x73,0x00, 0x00,0x00}, /* W */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x61,0x80, 0x73,0x80, 0x33,0x00, 0x3E,0x00, 0x1E,0x00, 0x0C,0x00, 0x1E,0x00, 0x1E,0x00, 0x33,0x00, 0x73,0x00, 0x61,0x80, 0xC1,0x80, 0x00,0x00}, /* X */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0xE1,0x80, 0x61,0x80, 0x73,0x00, 0x37,0x00, 0x1E,0x00, 0x1E,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* Y */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x80, 0x01,0x80, 0x03,0x00, 0x07,0x00, 0x06,0x00, 0x0E,0x00, 0x0C,0x00, 0x18,0x00, 0x38,0x00, 0x30,0x00, 0x60,0x00, 0x7F,0x80, 0x00,0x00}, /* Z */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1E,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00}, /* [ */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x60,0x00, 0x60,0x00, 0x30,0x00, 0x30,0x00, 0x18,0x00, 0x18,0x00, 0x0C,0x00, 0x0C,0x00, 0x06,0x00, 0x06,0x00, 0x07,0x00, 0x03,0x00, 0x03,0x00}, /* \ */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00}, /* ] */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1C,0x00, 0x3E,0x00, 0x33,0x00, 0x61,0x80, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* ^ */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* _ */
    {0x00,0x00, 0x00,0x00, 0x30,0x00, 0x18,0x00, 0x0C,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}, /* ` */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x63,0x00, 0x03,0x80, 0x3F,0x80, 0x71,0x80, 0x63,0x80, 0x63,0x80, 0x67,0x80, 0x3F,0x80, 0x00,0x00}, /* a */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x7E,0x00, 0x73,0x00, 0x71,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x71,0x80, 0x73,0x00, 0x7E,0x00, 0x00,0x00}, /* b */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1F,0x00, 0x39,0x80, 0x30,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x30,0x00, 0x39,0x80, 0x1F,0x00, 0x00,0x00}, /* c */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x03,0x00, 0x03,0x00, 0x03,0x00, 0x3F,0x00, 0x77,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x00, 0x77,0x00, 0x3F,0x00, 0x00,0x00}, /* d */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1E,0x00, 0x33,0x00, 0x61,0x80, 0x61,0x80, 0x7F,0x80, 0x60,0x00, 0x60,0x00, 0x31,0x80, 0x1F,0x00, 0x00,0x00}, /* e */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0F,0x80, 0x0C,0x00, 0x0C,0x00, 0x7F,0x80, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00}, /* f */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3F,0x00, 0x77,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x00, 0x77,0x00, 0x3F,0x00, 0x03,0x00}, /* g */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x60,0x00, 0x60,0x00, 0x60,0x00, 0x7E,0x00, 0x73,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x00,0x00}, /* h */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x3C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x7F,0x80, 0x00,0x00}, /* i */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x00,0x00, 0x3C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00}, /* j */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x30,0x00, 0x30,0x00, 0x30,0x00, 0x33,0x80, 0x37,0x00, 0x3E,0x00, 0x3C,0x00, 0x3C,0x00, 0x36,0x00, 0x33,0x00, 0x33,0x80, 0x31,0x80, 0x00,0x00}, /* k */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x78,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x0C,0x00, 0x0F,0x00, 0x00,0x00}, /* l */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x00, 0x6D,0x80, 0x4D,0x80, 0x4D,0x80, 0x4D,0x80, 0x4D,0x80, 0x4D,0x80, 0x4D,0x80, 0x4D,0x80, 0x00,0x00}, /* m */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7E,0x00, 0x73,0x00, 0x63,0x00, 0x63,0x00, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x00,0x00}, /* n */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x33,0x00, 0x63,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x63,0x80, 0x33,0x00, 0x3E,0x00, 0x00,0x00}, /* o */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7E,0x00, 0x73,0x00, 0x71,0x80, 0x61,0x80, 0x61,0x80, 0x61,0x80, 0x71,0x80, 0x73,0x00, 0x7E,0x00, 0x60,0x00}, /* p */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3F,0x80, 0x37,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x37,0x80, 0x3F,0x80, 0x01,0x80}, /* q */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x1F,0x80, 0x1C,0x80, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x00,0x00}, /* r */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x3E,0x00, 0x33,0x00, 0x60,0x00, 0x38,0x00, 0x3E,0x00, 0x07,0x00, 0x03,0x00, 0x63,0x00, 0x3E,0x00, 0x00,0x00}, /* s */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x18,0x00, 0x18,0x00, 0x7F,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x18,0x00, 0x1C,0x00, 0x0F,0x00, 0x00,0x00}, /* t */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x63,0x80, 0x37,0x80, 0x3F,0x80, 0x00,0x00}, /* u */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x61,0x80, 0x61,0x80, 0x63,0x00, 0x33,0x00, 0x33,0x00, 0x36,0x00, 0x1E,0x00, 0x1E,0x00, 0x1C,0x00, 0x00,0x00}, /* v */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0xC0,0xC0, 0xC0,0xC0, 0xC1,0x80, 0x4D,0x80, 0x7D,0x80, 0x7D,0x80, 0x77,0x00, 0x77,0x00, 0x33,0x00, 0x00,0x00}, /* w */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x63,0x80, 0x33,0x00, 0x3E,0x00, 0x1C,0x00, 0x0C,0x00, 0x1E,0x00, 0x37,0x00, 0x73,0x00, 0x61,0x80, 0x00,0x00}, /* x */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x61,0x80, 0x61,0x80, 0x33,0x00, 0x33,0x00, 0x33,0x00, 0x1E,0x00, 0x1E,0x00, 0x1C,0x00, 0x0C,0x00, 0x0C,0x00}, /* y */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7F,0x00, 0x03,0x00, 0x07,0x00, 0x0E,0x00, 0x0C,0x00, 0x18,0x00, 0x38,0x00, 0x70,0x00, 0x7F,0x00, 0x00,0x00}, /* z */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x07,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x1C,0x00, 0x78,0x00, 0x1C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00}, /* { */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00}, /* | */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x78,0x00, 0x1C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x07,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00, 0x0C,0x00}, /* } */
    {0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x7C,0x80, 0xCF,0x80, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00, 0x00,0x00}  /* ~ */
};

static uint8_t data_buff[SCREENWIDTH_IN_BYTES*PIXEL_HEIGHT];


void OLED_setup(){
    setup_tx();
}

/*

(x,y) - Screen Coords
1 - Set Pixel High
0 - Clear Pixel

*/

void OLED_set_pixel(const int x, const int y, const bool pixel_status){

    //Check if x/y coords are in bounds. If not, return.
    if ((x < 0) || (x >= PIXEL_WIDTH) || (y < 0) || (y >= PIXEL_HEIGHT)){
        return;
    }

    int const bit_shift_array[] = {7, 6, 5, 4, 3, 2, 1, 0};
    int byte_index = SCREENWIDTH_IN_BYTES*y + x/8;
    uint8_t bit_shift = bit_shift_array[x%8];

    //TODO: Implement as bitmask
    if(pixel_status){
        data_buff[byte_index] |=   (0x01 << bit_shift);
    } else {
        data_buff[byte_index] &=  ~(0x01 << bit_shift);
    }
    
}

/*
- Characters are assumed to be 16x12
- If a screen coord is specified that causes a portion of the character to be 
  past the screen boundary, the portion of the character outside of the screen
  boundary will NOT be drawn (i.e. it will not start on a newline)
- When characters are written, they will overwrite anything in the 16x12
  area designated for the character 
*/
void OLED_set_char(const char char_val, const int x, const int y){

    uint8_t char_index = char_val - ' '; 

    int const MSb_bit_shift[] = {7, 6, 5, 4, 3, 2, 1, 0};
    bool pixel_value;
    uint8_t row_byte;
    for (uint8_t row_index = 0; row_index < 16; row_index++){

        //Byte1
        for (uint8_t col_index = 0; col_index < 8; col_index++){
            row_byte = font16x12[char_index][2*row_index];
            pixel_value = (row_byte >> MSb_bit_shift[col_index]) & 0x01;

            OLED_set_pixel(x+col_index, y+row_index, pixel_value);
        }
        
        //Byte2
        for(uint8_t col_index = 8; col_index < 12; col_index++){
            row_byte = font16x12[char_index][2*row_index + 1];
            pixel_value = (row_byte >> MSb_bit_shift[col_index%8]) & 0x01;

            OLED_set_pixel(x+col_index, y+row_index, pixel_value);

        }

    }

}


void OLED_set_bitmap(const int x, const int y, const Bitmap * const bitmap_image){
    int const MSb_bit_shift[] = {7, 6, 5, 4, 3, 2, 1, 0};
    bool pixel_value;
    uint8_t row_byte;

    for(uint8_t row_index = 0; row_index < bitmap_image->bitmap_height; row_index++){ //row_in_image
        for(uint8_t byte_index = 0; byte_index < bitmap_image->bitmap_width; byte_index++){ //byte in row
            
            row_byte = bitmap_image->byte_array[row_index*bitmap_image->bitmap_width + byte_index];
            
            for (uint8_t bit_index = 0; bit_index < 8; bit_index++){
                pixel_value = (row_byte >> MSb_bit_shift[bit_index]) & 0x01;

                if(pixel_value){
                    OLED_set_pixel(x + byte_index*8+bit_index, y+row_index, pixel_value);
                } 
            }
        }
    }
}

void OLED_clear_frame_buffer(){
    memset(data_buff, 0, SCREENWIDTH_IN_BYTES*PIXEL_HEIGHT);
}

/*
Once the frame buffer has been adjusted to the user's liking, 
this sets the screen's output.
*/
int OLED_send_frame(){
    return send_tx(data_buff, SCREENWIDTH_IN_BYTES*PIXEL_HEIGHT);
}